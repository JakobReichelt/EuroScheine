<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Euro Bill Canvases</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.10.0/p5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.10.0/addons/p5.sound.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="sketch.js"></script>
</head>
<body>
  <script>
    // p5's loadImage() uses fetch/XHR under the hood, which is blocked for file:// URLs by most browsers.
    // Running from a local HTTP server avoids CORS errors.
    if (location.protocol === 'file:') {
      const msg = document.createElement('div');
      msg.style.cssText = [
        'position:fixed',
        'inset:0',
        'background:#0b0b0ccc',
        'color:#fff',
        'font:16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, sans-serif',
        'display:flex',
        'align-items:center',
        'justify-content:center',
        'padding:24px',
        'z-index:9999'
      ].join(';');
      msg.innerHTML = `
        <div style="max-width:720px;background:#15151a;border:1px solid #2a2a34;border-radius:12px;padding:18px 18px 16px;box-shadow:0 8px 30px rgba(0,0,0,.35)">
          <div style="font-size:18px;font-weight:600;margin-bottom:8px">Opened via file:// (images will fail to load)</div>
          <div style="opacity:.9;margin-bottom:10px">
            Your browser blocks loading images via <code>loadImage()</code> from <code>file://</code> URLs (CORS), so the sketch canâ€™t fetch files from <code>assets/</code>.
          </div>
          <div style="margin-bottom:10px">
            Start a local server in this folder (example):<br>
            <code style="display:inline-block;margin-top:6px;background:#0f0f14;padding:6px 8px;border-radius:8px;border:1px solid #2a2a34">python -m http.server 8000</code>
          </div>
          <div>
            Then open: <a href="http://localhost:8000/" style="color:#8ab4ff">http://localhost:8000/</a>
          </div>
        </div>
      `;
      document.body.appendChild(msg);
    }
  </script>
  <div id="canvas-container"></div>

  <!-- Download Modal -->
  <div id="downloadModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Download Canvas</h2>
        <button class="modal-close" id="closeModal">&times;</button>
      </div>
      
      <div class="modal-body">
        <div class="selection-group">
          <label>Select Canvas(es) to Download:</label>
          <div id="billPreviews" class="bill-previews">
            <!-- Bill previews will be generated here -->
          </div>
        </div>

        <div class="selection-group">
          <label>Select Side:</label>
          <div class="radio-group">
            <label class="radio-label">
              <input type="radio" name="side" value="front" checked>
              Front
            </label>
            <label class="radio-label">
              <input type="radio" name="side" value="back">
              Back
            </label>
            <label class="radio-label">
              <input type="radio" name="side" value="both">
              Both
            </label>
          </div>
        </div>

        <div class="selection-group">
          <label>File Format:</label>
          <div class="radio-group">
            <label class="radio-label">
              <input type="radio" name="format" value="png" checked>
              PNG
            </label>
            <label class="radio-label">
              <input type="radio" name="format" value="jpg">
              JPG
            </label>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button id="cancelBtn" class="btn btn-secondary">Cancel</button>
        <button id="downloadBtn" class="btn btn-primary">Download</button>
      </div>
    </div>
  </div>

  <!-- Download Button (visible in page) -->
  <button id="openDownloadBtn" class="download-button">Download Canvas</button>
</body>
</html>
